<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.com.papi.smarthomesense.mapper.SenseChannelMapper">
	<!-- 数据表和实体类的对应 -->
	<resultMap id="rs_ChannelBean" type="cn.com.papi.smarthomesense.bean.SenseChannelBean">
		<result property="id" column="id" javaType="java.lang.Integer"
			jdbcType="INTEGER" />
		<result property="idChannel" column="id_channel" javaType="java.lang.String"
			jdbcType="VARCHAR" />
		<result property="nameChannel" column="name_channel" javaType="java.lang.String"
			jdbcType="VARCHAR" />
		<result property="status" column="status" javaType="java.lang.Integer"
			jdbcType="INTEGER" />
		<result property="idGroup" column="id_Group" javaType="java.lang.Integer"
			jdbcType="INTEGER" />
		<result property="controlJson" column="control_json" javaType="java.lang.String"
			jdbcType="VARCHAR" />
		<result property="idDevice" column="id_device" javaType="java.lang.String"
			jdbcType="VARCHAR" />
	</resultMap>
	
	<!-- 添加 -->
	<insert id="insert" parameterType="cn.com.papi.smarthomesense.bean.SenseChannelBean">
		insert into sense_channel
		(id,id_channel,status,name_channel,id_Group,control_json,id_device)
		values (#{id},
				#{idChannel},
				#{status},				
				#{nameChannel},
				#{idGroup},
				#{controlJson},
				#{idDevice})
		<selectKey keyProperty="id" resultType="int" order="AFTER">
			select LAST_INSERT_ID()
		</selectKey>
	</insert>

	<!-- 删除 -->
	<delete id="deleteByChannel" parameterType="java.util.Map">
		DELETE FROM sense_channel
		<trim prefix="where" prefixOverrides="and | or">
			<if test="null != idChannel">
				AND id_channel=#{idChannel}
			</if>
		</trim>
	</delete>
	
	<delete id="deleteByBean" parameterType="cn.com.papi.smarthomesense.bean.SenseChannelBean">
		DELETE FROM sense_channel
		<trim prefix="where" prefixOverrides="and | or">

			<if test="null != idGroup and idGroup!=0">
				AND id_Group=#{idGroup}
			</if>
			<if test="null != idChannel">
				AND id_channel=#{idChannel}
			</if>
			<if test="null != id  and 0 != id">
				AND id=#{id}
			</if>
		</trim>
	</delete>
	
	<delete id="deleteByIdDevice" parameterType="java.util.Map">
	    DELETE FROM sense_channel
	    <where>
	        id_device=#{idDevice}
	    </where>
	</delete>
	
	<!-- 查看 -->
	<select id="listByBean" resultMap="rs_ChannelBean"
		parameterType="cn.com.papi.smarthomesense.bean.SenseChannelBean">
		SELECT * FROM sense_channel
		<trim prefix="where" prefixOverrides="and | or">
		    <if test="null != idDevice">
		        AND id_device=#{idDevice}
		    </if>
			<if test="null != idChannel ">
				AND id_channel=#{idChannel}
			</if>
			<if test="null != idGroup and idGroup!=0">
				AND id_group=#{idGroup}
			</if>
			<if test="null != id and id!=0">
				AND id=#{id}
			</if>
		</trim>
	</select>
	
	<select id="listByIdDevice" parameterType="java.util.Map" resultMap="rs_ChannelBean">
	   SELECT * FROM sense_channel
	   <where>
	       id_device = #{idDevice}
	   </where>
	</select>
	
	<!-- 修改 -->
	<update id="update" parameterType="cn.com.papi.smarthomesense.bean.SenseChannelBean">
		update sense_channel
		<set>
			<if test="status != null">
				status = #{status},
			</if>
			<if test="idGroup != null">
				id_group = #{idGroup},
			</if>
			<if test="nameChannel != null">
				name_channel = #{nameChannel},
			</if>
			<if test="controlJson != null">
				control_json = #{controlJson},
			</if>
						
		</set>
		WHERE
		<trim prefixOverrides="and | or">
			<if test="null != idChannel">
				AND id_channel=#{idChannel}
			</if>
			<if test="null != id">
				AND id=#{id}
			</if>
		</trim>
	</update>
	
</mapper>